<Page
    x:Class="Salami.SpreadsheetPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Salami"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Border Grid.Row="0" 
                Background="{StaticResource SalamiRed}"
                Padding="8,4">
            <StackPanel Orientation="Horizontal" Spacing="4">
                <Button Content="ðŸ“Š File" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="New Workbook" Click="New_Click"/>
                            <MenuFlyoutItem Text="Open..." Click="Open_Click"/>
                            <MenuFlyoutItem Text="Save" Click="Save_Click"/>
                            <MenuFlyoutItem Text="Save As..." Click="SaveAs_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Import CSV" Click="ImportCSV_Click"/>
                            <MenuFlyoutItem Text="Export to CSV" Click="ExportCSV_Click"/>
                            <MenuFlyoutItem Text="Export to PDF" Click="ExportPDF_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Print..." Click="Print_Click"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="âœï¸ Edit" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Undo"/>
                            <MenuFlyoutItem Text="Redo"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Cut"/>
                            <MenuFlyoutItem Text="Copy"/>
                            <MenuFlyoutItem Text="Paste"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Find &amp; Replace"/>
                            <MenuFlyoutItem Text="Fill Down"/>
                            <MenuFlyoutItem Text="Fill Right"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸ“‹ Insert" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Insert Row" Click="InsertRow_Click"/>
                            <MenuFlyoutItem Text="Insert Column" Click="InsertColumn_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Insert Chart..." Click="InsertChart_Click"/>
                            <MenuFlyoutItem Text="Insert Function..." Click="InsertFunction_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Insert Comment"/>
                            <MenuFlyoutItem Text="Insert Hyperlink"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸŽ¨ Format" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Cell Format..." Click="FormatCell_Click"/>
                            <MenuFlyoutItem Text="Number Format..." Click="NumberFormat_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Row Height..."/>
                            <MenuFlyoutItem Text="Column Width..."/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Merge Cells" Click="MergeCells_Click"/>
                            <MenuFlyoutItem Text="Unmerge Cells" Click="UnmergeCells_Click"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸ“ˆ Data" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Sort A-Z" Click="SortAscending_Click"/>
                            <MenuFlyoutItem Text="Sort Z-A" Click="SortDescending_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Filter..." Click="Filter_Click"/>
                            <MenuFlyoutItem Text="Remove Filter" Click="ClearFilter_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Pivot Table..." Click="PivotTable_Click"/>
                            <MenuFlyoutItem Text="Data Validation..."/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸ“ Formulas" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Insert Function..." Click="InsertFunction_Click"/>
                            <MenuFlyoutItem Text="Sum" Click="InsertSum_Click"/>
                            <MenuFlyoutItem Text="Average" Click="InsertAverage_Click"/>
                            <MenuFlyoutItem Text="Count" Click="InsertCount_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Show Formulas" Click="ShowFormulas_Click"/>
                            <MenuFlyoutItem Text="Evaluate Formula..."/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸ” View" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Zoom In"/>
                            <MenuFlyoutItem Text="Zoom Out"/>
                            <MenuFlyoutItem Text="100%"/>
                            <MenuFlyoutSeparator/>
                            <ToggleMenuFlyoutItem Text="Freeze Panes" Click="FreezePanes_Click"/>
                            <ToggleMenuFlyoutItem Text="Show Gridlines" IsChecked="True"/>
                            <ToggleMenuFlyoutItem Text="Show Headers" IsChecked="True"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸ› ï¸ Tools" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Salami Calculator" Click="SalamiCalculator_Click"/>
                            <MenuFlyoutItem Text="Recipe Scaler" Click="RecipeScaler_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Macro Recorder..."/>
                            <MenuFlyoutItem Text="Options..."/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>
            </StackPanel>
        </Border>

        <!-- Formatting Toolbar -->
        <Border Grid.Row="1"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                BorderThickness="0,0,0,1"
                Padding="12,8">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <!-- Font -->
                <ComboBox x:Name="FontCombo" Width="140" PlaceholderText="Font">
                    <ComboBoxItem Content="Segoe UI" IsSelected="True"/>
                    <ComboBoxItem Content="Arial"/>
                    <ComboBoxItem Content="Calibri"/>
                </ComboBox>

                <ComboBox x:Name="FontSizeCombo" Width="70">
                    <ComboBoxItem Content="8"/>
                    <ComboBoxItem Content="10" IsSelected="True"/>
                    <ComboBoxItem Content="11"/>
                    <ComboBoxItem Content="12"/>
                    <ComboBoxItem Content="14"/>
                    <ComboBoxItem Content="16"/>
                </ComboBox>

                <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <!-- Styling -->
                <ToggleButton Content="B" FontWeight="Bold" Width="36"/>
                <ToggleButton Content="I" FontStyle="Italic" Width="36"/>
                <ToggleButton Content="U" Width="36"/>

                <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <!-- Colors -->
                <Button Content="ðŸŽ¨" Width="36" ToolTipService.ToolTip="Fill Color"/>
                <Button Content="A" Width="36" ToolTipService.ToolTip="Font Color"/>

                <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <!-- Alignment -->
                <ToggleButton Content="â¬…" Width="36"/>
                <ToggleButton Content="â†”" Width="36" IsChecked="True"/>
                <ToggleButton Content="âž¡" Width="36"/>

                <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <!-- Number Format -->
                <ComboBox x:Name="NumberFormatCombo" Width="120" PlaceholderText="Format">
                    <ComboBoxItem Content="General" IsSelected="True"/>
                    <ComboBoxItem Content="Number"/>
                    <ComboBoxItem Content="Currency"/>
                    <ComboBoxItem Content="Percentage"/>
                    <ComboBoxItem Content="Date"/>
                    <ComboBoxItem Content="Time"/>
                    <ComboBoxItem Content="Text"/>
                </ComboBox>

                <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <!-- Borders -->
                <Button Content="âŠž" Width="36" ToolTipService.ToolTip="Borders"/>
                <Button Content="ðŸ”€" Width="36" ToolTipService.ToolTip="Merge Cells" Click="MergeCells_Click"/>
                <Button Content="Î£" Width="36" ToolTipService.ToolTip="AutoSum" Click="InsertSum_Click"/>
            </StackPanel>
        </Border>

        <!-- Formula Bar -->
        <Border Grid.Row="2"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                BorderThickness="0,0,0,1"
                Padding="12,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" 
                          Text="fx"
                          FontWeight="Bold"
                          VerticalAlignment="Center"
                          Margin="0,0,12,0"/>

                <TextBox x:Name="CellReferenceBox"
                        Grid.Column="1"
                        Text="A1"
                        IsReadOnly="True"
                        VerticalAlignment="Center"/>

                <TextBox x:Name="FormulaBar"
                        Grid.Column="2"
                        PlaceholderText="Enter formula or value"
                        VerticalAlignment="Center"
                        Margin="12,0,0,0"
                        KeyDown="FormulaBar_KeyDown"/>
            </Grid>
        </Border>

        <!-- Spreadsheet Grid -->
        <ScrollViewer Grid.Row="3" 
                     HorizontalScrollBarVisibility="Auto"
                     VerticalScrollBarVisibility="Auto">
            <Grid x:Name="SpreadsheetGrid">
                <!-- Grid will be populated dynamically -->
            </Grid>
        </ScrollViewer>

        <!-- Status Bar -->
        <Border Grid.Row="4"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                BorderThickness="0,1,0,0"
                Padding="16,6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="16">
                    <TextBlock Text="Ready" Opacity="0.8"/>
                    <TextBlock x:Name="SelectionInfo" Text="Cell: A1" Opacity="0.8"/>
                    <TextBlock x:Name="StatsInfo" Text="Count: 0 | Sum: 0 | Average: 0" Opacity="0.8"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="12">
                    <!-- Sheet Tabs -->
                    <Button Content="Sheet 1" Style="{StaticResource AccentButtonStyle}" Click="Sheet1_Click"/>
                    <Button Content="Sheet 2" Click="Sheet2_Click"/>
                    <Button Content="Sheet 3" Click="Sheet3_Click"/>
                    <Button Content="+" Width="32" Click="AddSheet_Click" ToolTipService.ToolTip="Add Sheet"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>
