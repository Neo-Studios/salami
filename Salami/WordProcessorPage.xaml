<Page
    x:Class="Salami.WordProcessorPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Salami"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Border Grid.Row="0" 
                Background="{StaticResource SalamiRed}"
                Padding="8,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="4">
                    <Button Content="ðŸ“„ File" Width="80" Height="32">
                        <Button.Flyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="New" Click="New_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="N"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Open..." Click="Open_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="O"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Save" Click="Save_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="S"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Save As..." Click="SaveAs_Click"/>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Export to PDF" Click="ExportPDF_Click"/>
                                <MenuFlyoutItem Text="Print..." Click="Print_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="P"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Recent Documents"/>
                            </MenuFlyout>
                        </Button.Flyout>
                    </Button>

                    <Button Content="âœï¸ Edit" Width="80" Height="32">
                        <Button.Flyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="Undo" Click="Undo_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="Z"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Redo" Click="Redo_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="Y"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Cut" Click="Cut_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="X"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Copy" Click="Copy_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="C"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Paste" Click="Paste_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="V"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Select All" Click="SelectAll_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="A"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Find..." Click="Find_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="F"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Replace..." Click="Replace_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="H"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                            </MenuFlyout>
                        </Button.Flyout>
                    </Button>

                    <Button Content="ðŸŽ¨ Format" Width="80" Height="32">
                        <Button.Flyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="Font..." Click="Font_Click"/>
                                <MenuFlyoutItem Text="Paragraph..." Click="Paragraph_Click"/>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Bulleted List" Click="BulletList_Click"/>
                                <MenuFlyoutItem Text="Numbered List" Click="NumberList_Click"/>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Insert Image..." Click="InsertImage_Click"/>
                                <MenuFlyoutItem Text="Insert Table..." Click="InsertTable_Click"/>
                                <MenuFlyoutItem Text="Insert Link..." Click="InsertLink_Click"/>
                            </MenuFlyout>
                        </Button.Flyout>
                    </Button>

                    <Button Content="ðŸ“‹ Insert" Width="80" Height="32">
                        <Button.Flyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="Salami Template" Click="InsertSalamiTemplate_Click"/>
                                <MenuFlyoutItem Text="Recipe Format" Click="InsertRecipeTemplate_Click"/>
                                <MenuFlyoutItem Text="Tasting Notes" Click="InsertTastingTemplate_Click"/>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Page Break" Click="InsertPageBreak_Click"/>
                                <MenuFlyoutItem Text="Header/Footer" Click="InsertHeaderFooter_Click"/>
                                <MenuFlyoutItem Text="Page Number" Click="InsertPageNumber_Click"/>
                            </MenuFlyout>
                        </Button.Flyout>
                    </Button>

                    <Button Content="ðŸ” View" Width="80" Height="32">
                        <Button.Flyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="Zoom In" Click="ZoomIn_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="Add"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Zoom Out" Click="ZoomOut_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="Subtract"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Reset Zoom" Click="ZoomReset_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Modifiers="Control" Key="Number0"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutSeparator/>
                                <ToggleMenuFlyoutItem x:Name="ShowRulerToggle" Text="Show Ruler" Click="ToggleRuler_Click"/>
                                <ToggleMenuFlyoutItem x:Name="ShowLineNumbersToggle" Text="Show Line Numbers" Click="ToggleLineNumbers_Click"/>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Full Screen" Click="FullScreen_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Key="F11"/>
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                            </MenuFlyout>
                        </Button.Flyout>
                    </Button>

                    <Button Content="ðŸ› ï¸ Tools" Width="80" Height="32">
                        <Button.Flyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="Spell Check" Click="SpellCheck_Click"/>
                                <MenuFlyoutItem Text="Word Count" Click="WordCount_Click"/>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Options..." Click="Options_Click"/>
                            </MenuFlyout>
                        </Button.Flyout>
                    </Button>
                </StackPanel>

                <TextBlock Grid.Column="1" 
                          x:Name="DocumentTitleText"
                          Text="Untitled Document"
                          FontSize="16"
                          FontWeight="SemiBold"
                          Foreground="White"
                          VerticalAlignment="Center"
                          HorizontalAlignment="Center"/>

                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8">
                    <TextBlock x:Name="WordCountText"
                              Text="Words: 0"
                              Foreground="White"
                              VerticalAlignment="Center"
                              FontSize="12"/>
                    <TextBlock x:Name="CharCountText"
                              Text="Characters: 0"
                              Foreground="White"
                              VerticalAlignment="Center"
                              FontSize="12"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Formatting Toolbar -->
        <Border Grid.Row="1"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                BorderThickness="0,0,0,1"
                Padding="12,8">
            <ScrollViewer HorizontalScrollMode="Auto" HorizontalScrollBarVisibility="Auto" VerticalScrollMode="Disabled">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <!-- Font Selection -->
                    <ComboBox x:Name="FontFamilyCombo"
                             PlaceholderText="Font"
                             Width="150"
                             SelectionChanged="FontFamilyCombo_SelectionChanged">
                        <ComboBoxItem Content="Segoe UI" IsSelected="True"/>
                        <ComboBoxItem Content="Arial"/>
                        <ComboBoxItem Content="Times New Roman"/>
                        <ComboBoxItem Content="Calibri"/>
                        <ComboBoxItem Content="Courier New"/>
                        <ComboBoxItem Content="Georgia"/>
                        <ComboBoxItem Content="Verdana"/>
                    </ComboBox>

                    <!-- Font Size -->
                    <ComboBox x:Name="FontSizeCombo"
                             Width="70"
                             SelectionChanged="FontSizeCombo_SelectionChanged">
                        <ComboBoxItem Content="8"/>
                        <ComboBoxItem Content="9"/>
                        <ComboBoxItem Content="10"/>
                        <ComboBoxItem Content="11"/>
                        <ComboBoxItem Content="12" IsSelected="True"/>
                        <ComboBoxItem Content="14"/>
                        <ComboBoxItem Content="16"/>
                        <ComboBoxItem Content="18"/>
                        <ComboBoxItem Content="20"/>
                        <ComboBoxItem Content="24"/>
                        <ComboBoxItem Content="28"/>
                        <ComboBoxItem Content="32"/>
                        <ComboBoxItem Content="36"/>
                        <ComboBoxItem Content="48"/>
                        <ComboBoxItem Content="72"/>
                    </ComboBox>

                    <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                    <!-- Text Styling -->
                    <ToggleButton x:Name="BoldToggle" 
                                 Content="B" 
                                 FontWeight="Bold"
                                 Width="40"
                                 Click="BoldToggle_Click"
                                 ToolTipService.ToolTip="Bold (Ctrl+B)"/>
                    <ToggleButton x:Name="ItalicToggle" 
                                 Content="I" 
                                 FontStyle="Italic"
                                 Width="40"
                                 Click="ItalicToggle_Click"
                                 ToolTipService.ToolTip="Italic (Ctrl+I)"/>
                    <ToggleButton x:Name="UnderlineToggle" 
                                 Content="U" 
                                 Width="40"
                                 Click="UnderlineToggle_Click"
                                 ToolTipService.ToolTip="Underline (Ctrl+U)"/>
                    <ToggleButton x:Name="StrikethroughToggle" 
                                 Content="S" 
                                 Width="40"
                                 Click="StrikethroughToggle_Click"
                                 ToolTipService.ToolTip="Strikethrough"/>

                    <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                    <!-- Text Color -->
                    <Button x:Name="TextColorButton" 
                           Content="ðŸŽ¨" 
                           Width="40"
                           Click="TextColor_Click"
                           ToolTipService.ToolTip="Text Color"/>
                    <Button x:Name="HighlightButton" 
                           Content="ðŸ–ï¸" 
                           Width="40"
                           Click="Highlight_Click"
                           ToolTipService.ToolTip="Highlight"/>

                    <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                    <!-- Alignment -->
                    <ToggleButton x:Name="AlignLeftToggle" 
                                 Content="â¬…ï¸" 
                                 Width="40"
                                 IsChecked="True"
                                 Click="AlignLeft_Click"
                                 ToolTipService.ToolTip="Align Left"/>
                    <ToggleButton x:Name="AlignCenterToggle" 
                                 Content="â†”ï¸" 
                                 Width="40"
                                 Click="AlignCenter_Click"
                                 ToolTipService.ToolTip="Center"/>
                    <ToggleButton x:Name="AlignRightToggle" 
                                 Content="âž¡ï¸" 
                                 Width="40"
                                 Click="AlignRight_Click"
                                 ToolTipService.ToolTip="Align Right"/>
                    <ToggleButton x:Name="AlignJustifyToggle" 
                                 Content="â¬Œ" 
                                 Width="40"
                                 Click="AlignJustify_Click"
                                 ToolTipService.ToolTip="Justify"/>

                    <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                    <!-- Lists -->
                    <ToggleButton x:Name="BulletListToggle" 
                                 Content="â€¢ List" 
                                 Width="60"
                                 Click="BulletList_Click"
                                 ToolTipService.ToolTip="Bullet List"/>
                    <ToggleButton x:Name="NumberListToggle" 
                                 Content="1. List" 
                                 Width="60"
                                 Click="NumberList_Click"
                                 ToolTipService.ToolTip="Numbered List"/>

                    <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                    <!-- Indentation -->
                    <Button Content="â¬… Outdent" 
                           Width="80"
                           Click="DecreaseIndent_Click"
                           ToolTipService.ToolTip="Decrease Indent"/>
                    <Button Content="Indent âž¡" 
                           Width="80"
                           Click="IncreaseIndent_Click"
                           ToolTipService.ToolTip="Increase Indent"/>

                    <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                    <!-- Line Spacing -->
                    <ComboBox x:Name="LineSpacingCombo"
                             PlaceholderText="Spacing"
                             Width="100"
                             SelectionChanged="LineSpacingCombo_SelectionChanged">
                        <ComboBoxItem Content="Single" IsSelected="True"/>
                        <ComboBoxItem Content="1.15"/>
                        <ComboBoxItem Content="1.5"/>
                        <ComboBoxItem Content="Double"/>
                    </ComboBox>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Document Editor -->
        <Border Grid.Row="2"
                Background="#F5F5F5"
                Padding="40,24">
            <ScrollViewer>
                <Border Background="White"
                       CornerRadius="4"
                       Padding="96,96"
                       MinHeight="1056"
                       MaxWidth="816"
                       HorizontalAlignment="Center"
                       Effect="{StaticResource CompatibleCardShadow}">
                    <RichEditBox x:Name="DocumentEditor"
                                TextWrapping="Wrap"
                                BorderThickness="0"
                                FontSize="12"
                                FontFamily="Segoe UI"
                                AcceptsReturn="True"
                                TextChanged="DocumentEditor_TextChanged"
                                SelectionChanged="DocumentEditor_SelectionChanged"
                                MinHeight="800"/>
                </Border>
            </ScrollViewer>
        </Border>

        <!-- Status Bar -->
        <Border Grid.Row="3"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                BorderThickness="0,1,0,0"
                Padding="16,6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="16">
                    <TextBlock x:Name="LineColumnText"
                              Text="Ln 1, Col 1"
                              FontSize="12"
                              Opacity="0.8"/>
                    <TextBlock x:Name="StatusText"
                              Text="Ready"
                              FontSize="12"
                              Opacity="0.8"/>
                    <TextBlock x:Name="PageCountText"
                              Text="Page 1 of 1"
                              FontSize="12"
                              Opacity="0.8"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="Zoom:"
                              FontSize="12"
                              Opacity="0.8"
                              VerticalAlignment="Center"/>
                    <Slider x:Name="ZoomSlider"
                           Minimum="50"
                           Maximum="200"
                           Value="100"
                           Width="120"
                           ValueChanged="ZoomSlider_ValueChanged"/>
                    <TextBlock x:Name="ZoomText"
                              Text="100%"
                              FontSize="12"
                              Opacity="0.8"
                              VerticalAlignment="Center"
                              Width="50"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>
