<Page
    x:Class="Salami.PresentationPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Salami"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Border Grid.Row="0" 
                Background="{StaticResource SalamiRed}"
                Padding="8,4">
            <StackPanel Orientation="Horizontal" Spacing="4">
                <Button Content="ðŸ“½ï¸ File" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="New Presentation" Click="New_Click"/>
                            <MenuFlyoutItem Text="Open..." Click="Open_Click"/>
                            <MenuFlyoutItem Text="Save" Click="Save_Click"/>
                            <MenuFlyoutItem Text="Save As..." Click="SaveAs_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Export to PDF" Click="ExportPDF_Click"/>
                            <MenuFlyoutItem Text="Export to Video" Click="ExportVideo_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Print Handouts..." Click="PrintHandouts_Click"/>
                            <MenuFlyoutItem Text="Print Notes..." Click="PrintNotes_Click"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="âœï¸ Edit" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Undo"/>
                            <MenuFlyoutItem Text="Redo"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Cut"/>
                            <MenuFlyoutItem Text="Copy"/>
                            <MenuFlyoutItem Text="Paste"/>
                            <MenuFlyoutItem Text="Duplicate Slide" Click="DuplicateSlide_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Select All"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸ“Š Insert" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="New Slide" Click="NewSlide_Click"/>
                            <MenuFlyoutItem Text="Duplicate Slide" Click="DuplicateSlide_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Text Box" Click="InsertTextBox_Click"/>
                            <MenuFlyoutItem Text="Image..." Click="InsertImage_Click"/>
                            <MenuFlyoutItem Text="Shape" Click="InsertShape_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Chart..." Click="InsertChart_Click"/>
                            <MenuFlyoutItem Text="Table..." Click="InsertTable_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Video..." Click="InsertVideo_Click"/>
                            <MenuFlyoutItem Text="Audio..." Click="InsertAudio_Click"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸŽ¨ Design" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Theme..." Click="ChooseTheme_Click"/>
                            <MenuFlyoutItem Text="Slide Size..." Click="SlideSize_Click"/>
                            <MenuFlyoutItem Text="Background..." Click="Background_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Salami Theme" Click="SalamiTheme_Click"/>
                            <MenuFlyoutItem Text="Professional Theme" Click="ProfessionalTheme_Click"/>
                            <MenuFlyoutItem Text="Modern Theme" Click="ModernTheme_Click"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸŽ¬ Transitions" Width="90" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="None" Click="TransitionNone_Click"/>
                            <MenuFlyoutItem Text="Fade" Click="TransitionFade_Click"/>
                            <MenuFlyoutItem Text="Slide" Click="TransitionSlide_Click"/>
                            <MenuFlyoutItem Text="Zoom" Click="TransitionZoom_Click"/>
                            <MenuFlyoutItem Text="Flip" Click="TransitionFlip_Click"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Apply to All" Click="ApplyTransitionToAll_Click"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="âœ¨ Animations" Width="90" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Entrance Effects"/>
                            <MenuFlyoutItem Text="Exit Effects"/>
                            <MenuFlyoutItem Text="Emphasis Effects"/>
                            <MenuFlyoutItem Text="Motion Paths"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Animation Pane" Click="AnimationPane_Click"/>
                            <MenuFlyoutItem Text="Timing..." Click="AnimationTiming_Click"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="â–¶ï¸ Slideshow" Width="90" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="From Beginning" Click="PlayFromStart_Click">
                                <MenuFlyoutItem.KeyboardAccelerators>
                                    <KeyboardAccelerator Key="F5"/>
                                </MenuFlyoutItem.KeyboardAccelerators>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Text="From Current Slide" Click="PlayFromCurrent_Click">
                                <MenuFlyoutItem.KeyboardAccelerators>
                                    <KeyboardAccelerator Modifiers="Shift" Key="F5"/>
                                </MenuFlyoutItem.KeyboardAccelerators>
                            </MenuFlyoutItem>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Presenter View" Click="PresenterView_Click"/>
                            <MenuFlyoutItem Text="Setup Show..." Click="SetupShow_Click"/>
                            <MenuFlyoutItem Text="Record Slideshow..." Click="RecordShow_Click"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>

                <Button Content="ðŸ” View" Width="80" Height="32">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Normal View" Click="NormalView_Click"/>
                            <MenuFlyoutItem Text="Outline View" Click="OutlineView_Click"/>
                            <MenuFlyoutItem Text="Slide Sorter" Click="SlideSorter_Click"/>
                            <MenuFlyoutItem Text="Notes View" Click="NotesView_Click"/>
                            <MenuFlyoutSeparator/>
                            <ToggleMenuFlyoutItem Text="Show Ruler" IsChecked="True"/>
                            <ToggleMenuFlyoutItem Text="Show Guidelines" IsChecked="True"/>
                            <MenuFlyoutSeparator/>
                            <MenuFlyoutItem Text="Zoom..."/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>
            </StackPanel>
        </Border>

        <!-- Toolbar -->
        <Border Grid.Row="1"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                BorderThickness="0,0,0,1"
                Padding="12,8">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <Button Content="âž• New Slide" Click="NewSlide_Click"/>
                <Button Content="ðŸ“‹ Duplicate" Click="DuplicateSlide_Click"/>
                <Button Content="ðŸ—‘ï¸ Delete" Click="DeleteSlide_Click"/>

                <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <Button Content="ðŸ“ Text Box" Click="InsertTextBox_Click"/>
                <Button Content="ðŸ–¼ï¸ Image" Click="InsertImage_Click"/>
                <Button Content="ðŸ”· Shape" Click="InsertShape_Click"/>

                <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <Button Content="â¬†ï¸ Move Up" Click="MoveSlideUp_Click"/>
                <Button Content="â¬‡ï¸ Move Down" Click="MoveSlideDown_Click"/>

                <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <ComboBox x:Name="LayoutCombo" PlaceholderText="Layout" Width="150">
                    <ComboBoxItem Content="Title Slide"/>
                    <ComboBoxItem Content="Title and Content" IsSelected="True"/>
                    <ComboBoxItem Content="Two Content"/>
                    <ComboBoxItem Content="Comparison"/>
                    <ComboBoxItem Content="Blank"/>
                </ComboBox>

                <Border Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <Button Content="â–¶ï¸ Play" 
                       Style="{StaticResource AccentButtonStyle}"
                       Click="PlayFromStart_Click"/>
            </StackPanel>
        </Border>

        <!-- Main Content Area -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>

            <!-- Slide Thumbnails -->
            <Border Grid.Column="0"
                   Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                   BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                   BorderThickness="0,0,1,0"
                   Padding="12">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                              Text="Slides"
                              FontSize="18"
                              FontWeight="SemiBold"
                              Margin="0,0,0,12"/>

                    <ScrollViewer Grid.Row="1">
                        <StackPanel x:Name="SlidesList" Spacing="8">
                            <!-- Slide thumbnails will be added here -->
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- Slide Canvas -->
            <Border Grid.Column="1"
                   Background="#E0E0E0"
                   Padding="40">
                <Grid>
                    <Border Background="White"
                           CornerRadius="4"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Width="960"
                           Height="540"
                           Effect="{StaticResource CompatibleCardShadow}">
                        <Grid x:Name="SlideCanvas">
                            <!-- Current slide content will be rendered here -->
                        </Grid>
                    </Border>
                </Grid>
            </Border>

            <!-- Properties Panel -->
            <Border Grid.Column="2"
                   Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                   BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                   BorderThickness="1,0,0,0"
                   Padding="16">
                <ScrollViewer>
                    <StackPanel Spacing="16">
                        <!-- Slide Properties -->
                        <StackPanel Spacing="12">
                            <TextBlock Text="Slide Properties"
                                      FontSize="18"
                                      FontWeight="SemiBold"/>

                            <StackPanel Spacing="8">
                                <TextBlock Text="Title" FontSize="14" FontWeight="SemiBold"/>
                                <TextBox x:Name="SlideTitleBox"
                                        PlaceholderText="Slide title"
                                        TextChanged="SlideTitleBox_TextChanged"/>
                            </StackPanel>

                            <StackPanel Spacing="8">
                                <TextBlock Text="Background" FontSize="14" FontWeight="SemiBold"/>
                                <Button Content="Choose Color" Click="ChooseBackgroundColor_Click" HorizontalAlignment="Stretch"/>
                                <Button Content="Choose Image" Click="ChooseBackgroundImage_Click" HorizontalAlignment="Stretch"/>
                            </StackPanel>

                            <StackPanel Spacing="8">
                                <TextBlock Text="Transition" FontSize="14" FontWeight="SemiBold"/>
                                <ComboBox x:Name="TransitionCombo" HorizontalAlignment="Stretch">
                                    <ComboBoxItem Content="None" IsSelected="True"/>
                                    <ComboBoxItem Content="Fade"/>
                                    <ComboBoxItem Content="Slide"/>
                                    <ComboBoxItem Content="Zoom"/>
                                    <ComboBoxItem Content="Flip"/>
                                </ComboBox>
                                <TextBlock Text="Duration (seconds)"/>
                                <Slider x:Name="TransitionDurationSlider"
                                       Minimum="0.5"
                                       Maximum="5"
                                       Value="1"
                                       StepFrequency="0.5"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Templates -->
                        <StackPanel Spacing="12">
                            <TextBlock Text="Salami Templates"
                                      FontSize="18"
                                      FontWeight="SemiBold"/>

                            <Button Content="ðŸ– Salami Varieties"
                                   Click="TemplateSalamiVarieties_Click"
                                   HorizontalAlignment="Stretch"/>
                            <Button Content="ðŸ§€ Pairing Guide"
                                   Click="TemplatePairingGuide_Click"
                                   HorizontalAlignment="Stretch"/>
                            <Button Content="ðŸ“œ Recipe Slide"
                                   Click="TemplateRecipe_Click"
                                   HorizontalAlignment="Stretch"/>
                            <Button Content="ðŸ“Š Comparison"
                                   Click="TemplateComparison_Click"
                                   HorizontalAlignment="Stretch"/>
                        </StackPanel>

                        <!-- Speaker Notes -->
                        <StackPanel Spacing="12">
                            <TextBlock Text="Speaker Notes"
                                      FontSize="18"
                                      FontWeight="SemiBold"/>

                            <TextBox x:Name="SpeakerNotesBox"
                                    PlaceholderText="Add notes for this slide..."
                                    TextWrapping="Wrap"
                                    AcceptsReturn="True"
                                    Height="150"
                                    TextChanged="SpeakerNotesBox_TextChanged"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="3"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                BorderThickness="0,1,0,0"
                Padding="16,6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="16">
                    <TextBlock x:Name="SlideCountText" Text="Slide 1 of 1" Opacity="0.8"/>
                    <TextBlock x:Name="StatusText" Text="Ready" Opacity="0.8"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="Zoom:" Opacity="0.8" VerticalAlignment="Center"/>
                    <Slider x:Name="ZoomSlider"
                           Minimum="25"
                           Maximum="200"
                           Value="100"
                           Width="120"/>
                    <TextBlock x:Name="ZoomText" Text="100%" Opacity="0.8" VerticalAlignment="Center" Width="50"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>
